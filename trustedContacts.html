<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Trusted Contacts – Guardian AI</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">

  <style>
    :root{
      --ink:#0f172a;
      --muted:#64748b;
      --line:#e5e7eb;
      --bg:#f8fafc;
      --card:#ffffff;
      --shadow:0 14px 30px rgba(15,23,42,.06);
      --radius:18px;

      --green:#16a34a;
      --green-bg:#ecfdf5;
      --green-line:#bbf7d0;

      --blue:#2563eb;
      --blue-bg:#eff6ff;
      --blue-line:#bfdbfe;

      --purple:#7c3aed;
      --purple-bg:#f5f3ff;
      --purple-line:#ddd6fe;

      --btn:#0f8f5a;
      --btn-hover:#0b7a4c;

      --info-bg:#eef6ff;
      --info-line:#cfe3ff;

      --danger:#ef4444;
      --danger-bg:#fef2f2;
      --danger-line:#fecaca;

      --amber:#f59e0b;
      --amber-bg:#fffbeb;
      --amber-line:#fde68a;
    }

    *{ box-sizing:border-box; }
    body{
      margin:0;
      font-family:Inter,system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;
      background:var(--bg);
      color:var(--ink);
    }

    /* ===================== TOP NAV (STICKY) ===================== */
    .top-nav{
      position: sticky;
      top: 0;
      z-index: 9998;
      background: rgba(255,255,255,.88);
      backdrop-filter: blur(10px);
      -webkit-backdrop-filter: blur(10px);
      border-bottom: 1px solid rgba(226,232,240,.9);
    }
    .top-nav .nav-inner{
      max-width: 1200px;
      margin: 0 auto;
      padding: 14px 18px;
      display: flex;
      align-items: center;
      gap: 16px;
    }
    .nav-brand{
      display:flex;
      align-items:center;
      gap:12px;
      font-weight:900;
      letter-spacing:-.01em;
      color:#0b1220;
      min-width: 180px;
      text-decoration:none;
    }
    .nav-logo{
      width:42px;height:42px;
      border-radius:14px;
      background: rgba(110,231,184,.14);
      border:1px solid rgba(110,231,184,.34);
      display:grid;place-items:center;
      color:#065f46;
    }
    .nav-title{
      display:flex;
      flex-direction:column;
      line-height:1.05;
    }
    .nav-title strong{ font-size:15px; }
    .nav-title span{
      font-size:12px;
      color:#64748b;
      font-weight:700;
      margin-top:2px;
    }

    .nav-links{
      display:flex;
      align-items:center;
      gap: 6px;
      flex: 1;
      justify-content: center;
    }
    .nav-links a{
      font-weight:800;
      font-size:13px;
      color:#0b1220;
      padding:10px 12px;
      border-radius:12px;
      border:1px solid transparent;
      transition: .15s ease;
      white-space: nowrap;
      text-decoration:none;
    }
    .nav-links a:hover{
      background: rgba(15,23,42,.06);
      border-color: rgba(15,23,42,.06);
    }
    .nav-links a.active{
      background: rgba(52,211,153,.18);
      border-color: rgba(52,211,153,.40);
      color:#065f46;
    }

    .nav-actions{
      display:flex;
      align-items:center;
      gap:10px;
      justify-content:flex-end;
      min-width: 230px;
    }
    .nav-btn{
      height:42px;
      padding: 0 14px;
      border-radius: 12px;
      font-weight:900;
      font-size:13px;
      display:inline-flex;
      align-items:center;
      justify-content:center;
      border: 1px solid rgba(15,23,42,.10);
      background: #fff;
      color:#0b1220;
      cursor:pointer;
      transition: .15s ease;
      white-space: nowrap;
    }
    .nav-btn:hover{ background: rgba(15,23,42,.04); }
    .nav-btn.primary{
      background: #0b1220;
      border-color: #0b1220;
      color:#fff;
    }
    .nav-btn.primary:hover{ filter: brightness(1.05); }

    .nav-toggle{
      display:none;
      width:44px;height:44px;
      border-radius: 14px;
      border: 1px solid rgba(15,23,42,.10);
      background: #fff;
      cursor:pointer;
    }
    .nav-toggle span{
      display:block;
      width:18px;height:2px;
      background:#0b1220;
      margin: 4px auto;
      border-radius:99px;
    }

    .nav-mobile{
      display:none;
      border-top:1px solid rgba(226,232,240,.9);
      background: rgba(255,255,255,.92);
    }
    .nav-mobile .nav-mobile-inner{
      max-width: 1200px;
      margin: 0 auto;
      padding: 10px 18px 14px;
      display:flex;
      flex-direction:column;
      gap:8px;
    }
    .nav-mobile a{
      font-weight:900;
      font-size:14px;
      padding:12px 12px;
      border-radius: 14px;
      background: rgba(15,23,42,.04);
      border: 1px solid rgba(15,23,42,.06);
      text-decoration:none;
      color:#0b1220;
    }
    .nav-mobile a.active{
      background: rgba(52,211,153,.18);
      border-color: rgba(52,211,153,.40);
      color:#065f46;
    }
    .nav-mobile .row{
      display:flex;
      gap:10px;
      margin-top:6px;
    }
    .nav-mobile .row .nav-btn{
      flex:1;
      height:46px;
      border-radius: 14px;
    }

    @media (max-width: 980px){
      .nav-links{ display:none; }
      .nav-actions{ display:none; }
      .nav-toggle{ display:block; margin-left:auto; }
      .nav-brand{ min-width: unset; }
      .top-nav .nav-inner{ padding: 12px 16px; }
      .nav-mobile{ display:block; }
      .nav-mobile[hidden]{ display:none; }
    }
    @media (max-width: 560px){
      .top-nav{ display:none; }
    }
    /* ===================== END TOP NAV ===================== */

    /* ===== MINI BAR (only on very small screens) ===== */
    .mini-bar {
      position: fixed;
      top: 14px;
      left: 14px;
      right: 14px;
      z-index: 9999;
      display: none;
      gap: 8px;
      background: #ffffff;
      padding: 10px 10px;
      border-radius: 14px;
      box-shadow: 0 8px 20px rgba(0,0,0,0.12);
      border: 1px solid rgba(226,232,240,.9);
      align-items:center;
    }
    .mini-bar .mini-left{
      display:flex;
      gap:8px;
      align-items:center;
      flex:1;
      min-width:0;
    }
    .mini-pill{
      display:inline-flex;
      align-items:center;
      gap:8px;
      padding:8px 10px;
      border-radius:12px;
      background: rgba(52,211,153,.12);
      border:1px solid rgba(52,211,153,.30);
      color:#065f46;
      font-weight:900;
      font-size:13px;
      white-space:nowrap;
      flex:0 0 auto;
    }
    .mini-bar select {
      width:100%;
      min-width:0;
      height:40px;
      padding: 0 10px;
      border-radius: 12px;
      border: 1px solid #e5e7eb;
      font-size: 14px;
      cursor: pointer;
      background:#fff;
      outline:none;
      font-weight:800;
    }
    .mini-bar button {
      height:40px;
      border: 1px solid rgba(15,23,42,.10);
      background: #f8fafc;
      padding: 0 12px;
      border-radius: 12px;
      cursor: pointer;
      font-weight:900;
      font-size:13px;
      white-space:nowrap;
    }
    .mini-bar button:hover { background: #eef2f7; }

    @media (max-width: 560px){
      .mini-bar{ display:flex; }
      .container{ padding-top: 96px; } /* leave room for mini-bar */
    }

    .container{
      width:min(1180px, calc(100% - 64px));
      margin:0 auto;
      padding:80px 0 110px;
    }

    /* Header */
    .head{
      text-align:center;
      margin-bottom:44px;
    }
    .headIcon{
      width:56px;
      height:56px;
      margin:0 auto 18px;
      border-radius:16px;
      background:#dcfce7;
      display:grid;
      place-items:center;
      color:var(--green);
    }
    h1{
      margin:0 0 10px;
      font-size:36px;
      font-weight:800;
      letter-spacing:-.03em;
    }
    .sub{
      max-width:820px;
      margin:0 auto;
      color:var(--muted);
      font-size:16px;
      line-height:1.65;
      font-weight:500;
    }

    /* Feature cards */
    .featureRow{
      display:grid;
      grid-template-columns:repeat(3, 1fr);
      gap:22px;
      margin:52px 0 26px;
      align-items:stretch;
    }
    .feature{
      background:var(--card);
      border:1px solid var(--line);
      border-radius:16px;
      padding:26px 20px;
      text-align:center;
      box-shadow:var(--shadow);
    }
    .feature.green{ background:var(--green-bg); border-color:var(--green-line); }
    .feature.blue{ background:var(--blue-bg); border-color:var(--blue-line); }
    .feature.purple{ background:var(--purple-bg); border-color:var(--purple-line); }

    .featIcon{
      width:44px;height:44px;
      margin:0 auto 14px;
      display:grid;
      place-items:center;
      color:currentColor;
    }
    .feature.green .featIcon{ color:var(--green); }
    .feature.blue .featIcon{ color:var(--blue); }
    .feature.purple .featIcon{ color:var(--purple); }

    .feature h3{
      margin:0 0 6px;
      font-size:14px;
      font-weight:800;
      letter-spacing:.01em;
    }
    .feature p{
      margin:0;
      font-size:13px;
      line-height:1.55;
      color:#475569;
      font-weight:600;
    }

    /* Main layout */
    .layout{
      display:grid;
      grid-template-columns: 1.08fr .92fr;
      gap:22px;
      align-items:start;
      margin-top:18px;
    }

    /* Card */
    .card{
      background:var(--card);
      border:1px solid var(--line);
      border-radius:16px;
      box-shadow:var(--shadow);
      overflow:hidden;
    }
    .cardHead{
      padding:18px 18px;
      border-bottom:1px solid var(--line);
      display:flex;
      align-items:flex-start;
      justify-content:space-between;
      gap:14px;
      flex-wrap:wrap;
    }
    .cardHead h2{
      margin:0;
      font-size:15px;
      font-weight:900;
      letter-spacing:-.01em;
    }
    .cardHead p{
      margin:6px 0 0;
      color:var(--muted);
      font-weight:600;
      font-size:13px;
      line-height:1.55;
      max-width:740px;
    }

    /* Buttons */
    .btnRow{
      display:flex;
      justify-content:flex-end;
      gap:10px;
    }
    .btn{
      height:38px;
      padding:0 16px;
      border-radius:8px;
      border:1px solid rgba(0,0,0,.08);
      background:var(--btn);
      color:#fff;
      font-weight:800;
      font-size:13px;
      display:inline-flex;
      align-items:center;
      gap:10px;
      cursor:pointer;
      box-shadow:0 12px 22px rgba(15,23,42,.08);
      white-space:nowrap;
    }
    .btn:hover{ background:var(--btn-hover); }
    .btn.secondary{ background:#0f172a; }
    .btn.secondary:hover{ background:#111827; }
    .btn.ghost{
      background:#f1f5f9;
      color:#0f172a;
      box-shadow:none;
    }
    .btn.ghost:hover{ background:#e5e7eb; }
    .btn svg{ display:block; }

    /* Contacts list */
    .contactsWrap{ padding:16px 16px 18px; }

    .empty{
      border:1px dashed #cbd5e1;
      border-radius:14px;
      padding:22px 16px;
      text-align:center;
      color:var(--muted);
      font-weight:700;
      background:#fbfdff;
    }
    .empty .emptyTitle{
      font-weight:900;
      color:#0f172a;
      margin-bottom:8px;
    }
    .empty .emptyHint{
      font-weight:650;
      font-size:13px;
      line-height:1.55;
      margin-bottom:14px;
    }
    .empty .emptyActions{
      display:flex;
      gap:10px;
      justify-content:center;
      flex-wrap:wrap;
    }

    .list{
      display:flex;
      flex-direction:column;
      gap:12px;
      margin-top:10px;
    }
    .contact{
      border:1px solid #e6edf7;
      border-radius:14px;
      padding:14px 14px;
      background:#ffffff;
      display:flex;
      gap:12px;
      align-items:flex-start;
      justify-content:space-between;
    }
    .left{
      display:flex;
      gap:12px;
      align-items:flex-start;
      min-width:0;
    }
    .avatar{
      width:40px;
      height:40px;
      border-radius:12px;
      display:grid;
      place-items:center;
      background:#f1f5f9;
      border:1px solid #e5e7eb;
      color:#0f172a;
      font-weight:900;
      flex:0 0 auto;
    }
    .info{
      min-width:0;
    }
    .cname{
      margin:0;
      font-size:14px;
      font-weight:900;
      color:#0f172a;
      line-height:1.2;
      word-break:break-word;
    }
    .cmeta{
      margin:6px 0 0;
      color:#64748b;
      font-weight:700;
      font-size:12.5px;
      line-height:1.45;
    }
    .tags{
      margin-top:8px;
      display:flex;
      flex-wrap:wrap;
      gap:8px;
    }
    .tag{
      display:inline-flex;
      align-items:center;
      gap:6px;
      padding:6px 10px;
      border-radius:999px;
      font-size:12px;
      font-weight:900;
      border:1px solid rgba(15,23,42,.08);
      background:#f1f5f9;
      color:#0f172a;
      white-space:nowrap;
    }
    .tag.primary{ background:var(--green-bg); color:#166534; border-color:rgba(22,101,52,.15); }
    .tag.verify{ background:var(--blue-bg); color:#1d4ed8; border-color:rgba(29,78,216,.18); }
    .tag.emergency{ background:var(--danger-bg); color:#991b1b; border-color:rgba(153,27,27,.18); }
    .tag.sms{ background:#fff7ed; color:#9a3412; border-color:#fed7aa; }
    .tag.call{ background:#f0f9ff; color:#075985; border-color:#bae6fd; }
    .tag.email{ background:#eef2ff; color:#3730a3; border-color:#c7d2fe; }

    .actions{
      display:flex;
      flex-direction:column;
      gap:8px;
      align-items:flex-end;
      flex:0 0 auto;
    }
    .smallBtn{
      height:34px;
      padding:0 12px;
      border-radius:10px;
      border:1px solid #e5e7eb;
      background:#f8fafc;
      color:#0f172a;
      font-weight:900;
      font-size:12.5px;
      cursor:pointer;
      display:inline-flex;
      align-items:center;
      gap:8px;
      white-space:nowrap;
    }
    .smallBtn:hover{ background:#eef2f7; }
    .smallBtn.danger{
      background:#fff1f2;
      border-color:#fecdd3;
      color:#9f1239;
    }
    .smallBtn.danger:hover{ background:#ffe4e6; }

    .quickRow{
      display:flex;
      gap:8px;
      justify-content:flex-end;
      flex-wrap:wrap;
    }
    .chipBtn{
      height:32px;
      padding:0 10px;
      border-radius:999px;
      border:1px solid rgba(15,23,42,.10);
      background:#fff;
      font-weight:900;
      font-size:12px;
      cursor:pointer;
      color:#0f172a;
    }
    .chipBtn:hover{ background:#f8fafc; }

    /* AI Assist Card (mock) */
    .aiWrap{ padding:16px 16px 18px; }
    .aiBanner{
      display:flex;
      gap:12px;
      align-items:flex-start;
      padding:14px 14px;
      border-radius:14px;
      background: linear-gradient(180deg, #eff6ff 0%, #ffffff 100%);
      border:1px solid #c7ddff;
    }
    .aiIcon{
      width:42px;height:42px;
      border-radius:14px;
      display:grid;
      place-items:center;
      background:#eaf2ff;
      color:#2563eb;
      border:1px solid #bfdbfe;
      flex:0 0 auto;
      font-weight:900;
    }
    .aiBanner h3{
      margin:0;
      font-size:14px;
      font-weight:900;
      color:#0f172a;
    }
    .aiBanner p{
      margin:6px 0 0;
      color:#475569;
      font-weight:700;
      font-size:12.8px;
      line-height:1.55;
    }

    .aiBox{
      margin-top:12px;
      border:1px solid #e5e7eb;
      border-radius:14px;
      background:#ffffff;
      overflow:hidden;
    }
    .aiBoxHead{
      padding:12px 12px;
      border-bottom:1px solid #e5e7eb;
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:10px;
      background:#f8fafc;
      flex-wrap:wrap;
    }
    .pill{
      display:inline-flex;
      align-items:center;
      gap:8px;
      padding:6px 10px;
      border-radius:999px;
      font-size:12px;
      font-weight:900;
      border:1px solid rgba(15,23,42,.08);
      background:#f1f5f9;
      color:#0f172a;
      white-space:nowrap;
    }
    .pill.mock{
      background:#fffbeb;
      border-color:var(--amber-line);
      color:#92400e;
    }
    .aiChat{
      padding:12px 12px 12px;
      display:flex;
      flex-direction:column;
      gap:10px;
      max-height: 280px;
      overflow:auto;
    }
    .msg{
      max-width:92%;
      padding:10px 12px;
      border-radius:14px;
      border:1px solid #e5e7eb;
      background:#ffffff;
      font-weight:700;
      font-size:13px;
      line-height:1.55;
      color:#0f172a;
      white-space:pre-wrap;
    }
    .msg.ai{
      background:#eff6ff;
      border-color:#bfdbfe;
    }
    .msg.me{
      margin-left:auto;
      background:#f1f5f9;
    }
    .aiInputRow{
      display:flex;
      gap:10px;
      padding:12px 12px;
      border-top:1px solid #e5e7eb;
      background:#ffffff;
    }
    .aiInput{
      flex:1;
      height:40px;
      border-radius:12px;
      border:1px solid #e5e7eb;
      padding:0 12px;
      font-weight:700;
      outline:none;
      background:#fff;
    }
    .sendBtn{
      height:40px;
      padding:0 14px;
      border-radius:12px;
      border:1px solid rgba(0,0,0,.08);
      background:#0f172a;
      color:#fff;
      font-weight:900;
      cursor:pointer;
      white-space:nowrap;
    }
    .sendBtn:hover{ background:#111827; }

    /* Help box */
    .help{
      margin-top:18px;
      background:var(--info-bg);
      border:1px solid var(--info-line);
      border-radius:12px;
      padding:18px 18px;
      display:flex;
      gap:14px;
      align-items:flex-start;
    }
    .helpIcon{
      width:28px;height:28px;
      border-radius:999px;
      display:grid;
      place-items:center;
      color:#2563eb;
      flex:0 0 auto;
      margin-top:2px;
    }
    .help h5{
      margin:0 0 10px;
      font-size:14px;
      font-weight:900;
      color:#0f172a;
    }
    .help ul{
      margin:0;
      padding-left:0;
      list-style:none;
      display:flex;
      flex-direction:column;
      gap:10px;
      color:#0f172a;
      font-weight:600;
      font-size:13.5px;
      line-height:1.55;
    }
    .help li{
      display:flex;
      gap:10px;
      align-items:flex-start;
      color:#0f172a;
    }
    .tick{
      color:#0ea5e9;
      font-weight:900;
      margin-top:1px;
    }

    /* Modal */
    .modalOverlay{
      position:fixed;
      inset:0;
      background:rgba(15,23,42,.55);
      display:none;
      align-items:center;
      justify-content:center;
      padding:18px;
      z-index:99999;
    }
    .modal{
      width:min(560px, 100%);
      background:#fff;
      border-radius:18px;
      border:1px solid rgba(255,255,255,.2);
      box-shadow: 0 30px 70px rgba(0,0,0,.25);
      overflow:hidden;
    }
    .modalHead{
      padding:16px 16px;
      border-bottom:1px solid #e5e7eb;
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:12px;
      background:#f8fafc;
    }
    .modalHead h3{
      margin:0;
      font-size:14px;
      font-weight:900;
    }
    .xBtn{
      width:38px;height:38px;
      border-radius:12px;
      border:1px solid #e5e7eb;
      background:#fff;
      cursor:pointer;
      font-weight:900;
    }
    .xBtn:hover{ background:#eef2f7; }

    .modalBody{ padding:16px 16px 18px; }
    .grid2{
      display:grid;
      grid-template-columns:1fr 1fr;
      gap:12px;
    }
    label{
      display:block;
      font-size:12px;
      font-weight:900;
      color:#0f172a;
      margin-bottom:6px;
    }
    input, select{
      width:100%;
      height:42px;
      border-radius:12px;
      border:1px solid #e5e7eb;
      padding:0 12px;
      font-weight:700;
      outline:none;
      background:#fff;
    }
    input:focus, select:focus{
      border-color:#93c5fd;
      box-shadow:0 0 0 4px rgba(37,99,235,.12);
    }
    .hint{
      margin-top:6px;
      color:#64748b;
      font-weight:650;
      font-size:12.5px;
      line-height:1.45;
    }
    .row{ margin-top:12px; }
    .toggleRow{
      display:flex;
      gap:10px;
      flex-wrap:wrap;
      margin-top:8px;
    }
    .toggle{
      border:1px solid #e5e7eb;
      background:#f8fafc;
      border-radius:999px;
      padding:8px 10px;
      font-size:12px;
      font-weight:900;
      cursor:pointer;
      display:inline-flex;
      align-items:center;
      gap:8px;
    }
    .toggle.active{
      background:#0f172a;
      border-color:#0f172a;
      color:#fff;
    }

    .modalFoot{
      padding:14px 16px;
      border-top:1px solid #e5e7eb;
      display:flex;
      gap:10px;
      justify-content:flex-end;
      background:#fff;
      flex-wrap:wrap;
    }
    .btnLite{
      height:38px;
      padding:0 14px;
      border-radius:10px;
      border:1px solid #e5e7eb;
      background:#fff;
      font-weight:900;
      cursor:pointer;
    }
    .btnLite:hover{ background:#eef2f7; }
    .btnPrimary{
      height:38px;
      padding:0 14px;
      border-radius:10px;
      border:1px solid rgba(0,0,0,.08);
      background:var(--btn);
      color:#fff;
      font-weight:900;
      cursor:pointer;
    }
    .btnPrimary:hover{ background:var(--btn-hover); }

    /* Responsive */
    @media (max-width: 980px){
      .featureRow{ grid-template-columns:1fr; }
      .layout{ grid-template-columns:1fr; }
      .container{ width:min(980px, calc(100% - 28px)); }
      .btnRow{ justify-content:center; }
    }
    @media (max-width: 520px){
      .grid2{ grid-template-columns:1fr; }
    }
  </style>
</head>

<body>
  <!-- MINI BAR (small screens) -->
  <div class="mini-bar" role="navigation" aria-label="Quick navigation">
    <div class="mini-left">
      <span class="mini-pill">Guardian AI</span>
      <select id="pageSelect" aria-label="Choose a page">
        <option value="index.html">Home</option>
        <option value="scamanalyzer.html">Deepfake Analyzer</option>
        <option value="courses.html">Courses</option>
        <option value="trustedContacts.html">Trusted Contacts</option>
        <option value="alerts.html">Alerts</option>
        <option value="simulator.html">Simulator</option>
        <option value="report.html">Report</option>
      </select>
    </div>
    <button type="button" id="miniViewBtn" title="Toggle mobile preview width">Mobile</button>
  </div>

  <!-- TOP NAV -->
  <header class="top-nav">
    <div class="nav-inner">
      <a class="nav-brand" href="javascript:void(0)" onclick="switchPage('index.html')">
        <div class="nav-logo" aria-hidden="true">
          <svg width="22" height="22" viewBox="0 0 24 24" fill="none">
            <path d="M12 2l7 4v7c0 5-3.5 9-7 9s-7-4-7-9V6l7-4z" stroke="currentColor" stroke-width="2"/>
            <path d="M9 12l2 2 4-5" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
          </svg>
        </div>
        <div class="nav-title">
          <strong>Guardian AI</strong>
          <span>Scam Protection</span>
        </div>
      </a>

      <nav class="nav-links" aria-label="Primary">
        <a href="javascript:void(0)" onclick="switchPage('index.html')" data-page="index.html">Home</a>
        <a href="javascript:void(0)" onclick="switchPage('scamanalyzer.html')" data-page="scamanalyzer.html">Deepfake Analyzer</a>
        <a href="javascript:void(0)" onclick="switchPage('courses.html')" data-page="courses.html">Courses</a>
        <a href="javascript:void(0)" onclick="switchPage('trustedContacts.html')" data-page="trustedContacts.html">Trusted Contacts</a>
        <a href="javascript:void(0)" onclick="switchPage('alerts.html')" data-page="alerts.html">Alerts</a>
        <a href="javascript:void(0)" onclick="switchPage('simulator.html')" data-page="simulator.html">Simulator</a>
        <a href="javascript:void(0)" onclick="switchPage('report.html')" data-page="report.html">Report</a>
      </nav>

      <div class="nav-actions">
        <button class="nav-btn" type="button" onclick="switchPage('courses.html')">Start Learning</button>
        <button class="nav-btn primary" type="button" onclick="switchPage('scamanalyzer.html')">Analyze a Deepfake</button>
      </div>

      <button class="nav-toggle" type="button" aria-label="Open menu" aria-expanded="false" id="navToggle">
        <span></span><span></span><span></span>
      </button>
    </div>

    <div class="nav-mobile" id="navMobile" hidden>
      <div class="nav-mobile-inner">
        <a href="javascript:void(0)" onclick="switchPage('index.html')" data-page="index.html">Home</a>
        <a href="javascript:void(0)" onclick="switchPage('scamanalyzer.html')" data-page="scamanalyzer.html">Deepfake Analyzer</a>
        <a href="javascript:void(0)" onclick="switchPage('courses.html')" data-page="courses.html">Courses</a>
        <a href="javascript:void(0)" onclick="switchPage('trustedContacts.html')" data-page="trustedContacts.html">Trusted Contacts</a>
        <a href="javascript:void(0)" onclick="switchPage('alerts.html')" data-page="alerts.html">Alerts</a>
        <a href="javascript:void(0)" onclick="switchPage('simulator.html')" data-page="simulator.html">Simulator</a>
        <a href="javascript:void(0)" onclick="switchPage('report.html')" data-page="report.html">Report</a>
        <div class="row">
          <button class="nav-btn" type="button" onclick="switchPage('courses.html')">Start Learning</button>
          <button class="nav-btn primary" type="button" onclick="switchPage('scamanalyzer.html')">Analyze a Deepfake</button>
        </div>
      </div>
    </div>
  </header>

  <div class="container">
    <div class="head">
      <div class="headIcon" aria-hidden="true">
        <svg width="28" height="28" viewBox="0 0 24 24" fill="none">
          <path d="M16 11a3.2 3.2 0 1 0-6.4 0A3.2 3.2 0 0 0 16 11Z" stroke="currentColor" stroke-width="2"/>
          <path d="M20 20c0-3.2-3.1-5-6.8-5S6.4 16.8 6.4 20" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
          <path d="M7.2 10.6a2.7 2.7 0 1 1 0-5.4" stroke="currentColor" stroke-width="2" stroke-linecap="round" opacity=".6"/>
          <path d="M4 19.6c.2-2 1.3-3.3 3.3-4" stroke="currentColor" stroke-width="2" stroke-linecap="round" opacity=".6"/>
        </svg>
      </div>

      <h1>Trusted Contacts</h1>
      <p class="sub">
        Add 2–3 people you trust. When a scam feels urgent, you can copy a ready-to-send verification message and follow a clear “pause + verify” plan.
        Everything saves locally in your browser (no account needed).
      </p>
    </div>

    <div class="featureRow">
      <div class="feature green">
        <div class="featIcon" aria-hidden="true">
          <svg width="34" height="34" viewBox="0 0 24 24" fill="none">
            <path d="M12 3l7 4v6c0 5-3.1 8-7 9-3.9-1-7-4-7-9V7l7-4Z" stroke="currentColor" stroke-width="2" stroke-linejoin="round"/>
          </svg>
        </div>
        <h3>Feasible Verification</h3>
        <p>Copy a pre-written “verify this” message instead of guessing what to say.</p>
      </div>

      <div class="feature blue">
        <div class="featIcon" aria-hidden="true">
          <svg width="34" height="34" viewBox="0 0 24 24" fill="none">
            <path d="M18 8a6 6 0 10-12 0c0 7-3 7-3 7h18s-3 0-3-7Z" stroke="currentColor" stroke-width="2" stroke-linejoin="round"/>
            <path d="M10 18a2 2 0 004 0" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
          </svg>
        </div>
        <h3>Share What Happened</h3>
        <p>Copy a “verification plan” and share it for a second opinion.</p>
      </div>

      <div class="feature purple">
        <div class="featIcon" aria-hidden="true">
          <svg width="34" height="34" viewBox="0 0 24 24" fill="none">
            <path d="M12 2l1.2 4.3L17 8l-3.8 1.7L12 14l-1.2-4.3L7 8l3.8-1.7L12 2Z" stroke="currentColor" stroke-width="2" stroke-linejoin="round"/>
            <path d="M19 13l.7 2.5L22 16l-2.3.5L19 19l-.7-2.5L16 16l2.3-.5L19 13Z" stroke="currentColor" stroke-width="2" stroke-linejoin="round" opacity=".7"/>
          </svg>
        </div>
        <h3>AI Draft Helper (Mock)</h3>
        <p>Type what happened to generate a clean message template you can copy.</p>
      </div>
    </div>

    <div class="layout">
      <!-- CONTACTS -->
      <div class="card">
        <div class="cardHead">
          <div>
            <h2>Your Trusted Contacts</h2>
            <p>
              Tip: choose one <strong>Primary</strong> (first call), one <strong>Verifier</strong> (checks official numbers),
              and one <strong>Emergency</strong> (if money/info was shared).
            </p>
          </div>

          <div class="btnRow">
            <button class="btn secondary" type="button" id="copyPlanBtn" title="Copy a verification plan">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="none">
                <path d="M9 9h10v10H9V9Z" stroke="#fff" stroke-width="2" />
                <path d="M5 15H4a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h10a1 1 0 0 1 1 1v1" stroke="#fff" stroke-width="2" stroke-linecap="round"/>
              </svg>
              Copy Verification Plan
            </button>

            <button class="btn" type="button" id="addBtn">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="none">
                <path d="M15 20c0-3-3-5-6-5s-6 2-6 5" stroke="#fff" stroke-width="2" stroke-linecap="round"/>
                <path d="M9 12a4 4 0 1 0 0-8 4 4 0 0 0 0 8Z" stroke="#fff" stroke-width="2"/>
                <path d="M19 8v6" stroke="#fff" stroke-width="2" stroke-linecap="round"/>
                <path d="M16 11h6" stroke="#fff" stroke-width="2" stroke-linecap="round"/>
              </svg>
              Add Contact
            </button>
          </div>
        </div>

        <div class="contactsWrap">
          <div id="emptyState" class="empty">
            <div class="emptyTitle">No contacts yet</div>
            <div class="emptyHint">Add someone you trust (family, friend, neighbor). Then you can copy a ready-to-send verification message in one click.</div>
            <div class="emptyActions">
              <button class="btn" type="button" id="emptyAddBtn">Add your first contact</button>
              <button class="btn ghost" type="button" id="demoContactBtn">Add example contact</button>
            </div>
          </div>

          <div id="list" class="list" style="display:none;"></div>
        </div>
      </div>

      <!-- AI DRAFT (mock UI but page works) -->
      <div class="card">
        <div class="cardHead">
          <div>
            <h2>Message Draft (Mock)</h2>
            <p>
              This does not contact anyone. It only creates a message template you can copy and send yourself.
            </p>
          </div>
          <span class="pill mock">Mock</span>
        </div>

        <div class="aiWrap">
          <div class="aiBanner">
            <div class="aiIcon"></div>
            <div>
              <h3>Draft a verification message</h3>
              <p>Include who contacted you, what they asked for, and why it felt urgent. You’ll get a short, clear message to copy.</p>
            </div>
          </div>

          <div class="aiBox" aria-label="Mock AI chat">
            <div class="aiBoxHead">
              <span class="pill">Example prompt</span>
              <button class="btn ghost" type="button" id="insertPromptBtn">Insert</button>
            </div>

            <div class="aiChat" id="chat">
              <div class="msg ai" id="greetingMsg">
                Paste what happened (who contacted you, what they asked for, how urgent it felt). I’ll draft a short message to send to a trusted contact.
              </div>
            </div>

            <div class="aiInputRow">
              <input class="aiInput" id="aiInput" placeholder="Example: 'A caller said they were my bank and told me to move money now...'" />
              <button class="sendBtn" type="button" id="mockSendBtn">Create Draft</button>
            </div>
          </div>

          <div style="margin-top:12px; display:flex; gap:10px; flex-wrap:wrap;">
            <button class="smallBtn" type="button" id="copyDraftBtn">Copy Latest Draft</button>
            <button class="smallBtn" type="button" id="clearChatBtn">Clear</button>
          </div>
        </div>
      </div>
    </div>

    <div class="help">
      <div class="helpIcon" aria-hidden="true">
        <svg width="22" height="22" viewBox="0 0 24 24" fill="none">
          <path d="M12 22a10 10 0 1 0 0-20 10 10 0 0 0 0 20Z" stroke="currentColor" stroke-width="2"/>
          <path d="M12 10v7" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
          <path d="M12 7.2h.01" stroke="currentColor" stroke-width="3" stroke-linecap="round"/>
        </svg>
      </div>

      <div>
        <h5>How to use this fast</h5>
        <ul>
          <li><span class="tick">✓</span><span>Add one <strong>Primary</strong> and one <strong>Verifier</strong>.</span></li>
          <li><span class="tick">✓</span><span>When something feels urgent, click <strong>Copy Verify Message</strong> and send it.</span></li>
          <li><span class="tick">✓</span><span>Always call back using <strong>official numbers</strong> (website, card, saved contact).</span></li>
          <li><span class="tick">✓</span><span>Optional: set a <strong>family code word</strong> for identity checks.</span></li>
        </ul>
      </div>
    </div>
  </div>

  <!-- MODAL: ADD/EDIT CONTACT -->
  <div class="modalOverlay" id="modalOverlay" aria-hidden="true">
    <div class="modal" role="dialog" aria-modal="true" aria-labelledby="modalTitle">
      <div class="modalHead">
        <h3 id="modalTitle">Add Trusted Contact</h3>
        <button class="xBtn" type="button" id="closeModalBtn" aria-label="Close">✕</button>
      </div>

      <div class="modalBody">
        <div class="grid2">
          <div>
            <label for="nameInput">Name (required)</label>
            <input id="nameInput" placeholder="Example: Maria Chen" autocomplete="name" />
          </div>
          <div>
            <label for="relationInput">Relationship</label>
            <input id="relationInput" placeholder="Example: Daughter, Friend, Neighbor" />
          </div>
        </div>

        <div class="grid2" style="margin-top:12px;">
          <div>
            <label for="phoneInput">Phone (optional)</label>
            <input id="phoneInput" placeholder="Example: (555) 123-4567" inputmode="tel" autocomplete="tel" />
            <div class="hint">If you add a phone number, quick “Call/Text” buttons will appear.</div>
          </div>
          <div>
            <label for="methodSelect">Preferred Method</label>
            <select id="methodSelect">
              <option value="Call">Call</option>
              <option value="Text">Text</option>
              <option value="Email">Email</option>
            </select>
          </div>
        </div>

        <div class="row">
          <label>Roles (choose any)</label>
          <div class="toggleRow">
            <button class="toggle" type="button" data-role="Primary">Primary Contact</button>
            <button class="toggle" type="button" data-role="Verifier">Verifier</button>
            <button class="toggle" type="button" data-role="Emergency">Emergency</button>
          </div>
          <div class="hint">If you’re not sure, pick <strong>Primary</strong> for one person and <strong>Verifier</strong> for another.</div>
        </div>

        <div class="row">
          <label for="notesInput">Notes (optional)</label>
          <input id="notesInput" placeholder="Example: ‘Knows my bank; can help call them back’" />
        </div>

        <input type="hidden" id="editId" value="" />
      </div>

      <div class="modalFoot">
        <button class="btnLite" type="button" id="cancelBtn">Cancel</button>
        <button class="btnPrimary" type="button" id="saveBtn">Save Contact</button>
      </div>
    </div>
  </div>

  <script>
    /* ---------------- BASE-PATH SAFE NAV ---------------- */
    function getBaseDir() {
      const path = window.location.pathname;
      const parts = path.split("/");
      const last = parts[parts.length - 1];
      if (!last || last.includes(".html")) parts.pop();
      const base = parts.join("/") + (parts.length > 1 ? "/" : "/");
      return base;
    }
    function switchPage(page) {
      if (!page) return;
      if (/^https?:\/\//i.test(page)) { window.location.href = page; return; }
      window.location.href = getBaseDir() + page;
    }

    /* Active nav highlight */
    (function highlightActiveNav(){
      const file = (window.location.pathname.split("/").pop() || "index.html").toLowerCase();
      document.querySelectorAll('[data-page]').forEach(a => {
        a.classList.toggle('active', (a.getAttribute('data-page') || '').toLowerCase() === file);
      });
      const pageSelect = document.getElementById("pageSelect");
      if (pageSelect){
        [...pageSelect.options].forEach(opt => {
          opt.selected = (opt.value || "").toLowerCase() === file;
        });
        pageSelect.addEventListener("change", () => switchPage(pageSelect.value));
      }
    })();

    /* Nav toggle (tablet) */
    (function navToggle(){
      const btn = document.getElementById("navToggle");
      const panel = document.getElementById("navMobile");
      if (!btn || !panel) return;
      btn.addEventListener("click", () => {
        const open = !panel.hasAttribute("hidden");
        if (open) {
          panel.setAttribute("hidden", "");
          btn.setAttribute("aria-expanded", "false");
        } else {
          panel.removeAttribute("hidden");
          btn.setAttribute("aria-expanded", "true");
        }
      });
    })();

    /* Mini-bar mobile preview toggle */
    (function miniPreview(){
      const btn = document.getElementById("miniViewBtn");
      if (!btn) return;
      btn.addEventListener("click", () => {
        const meta = document.querySelector('meta[name="viewport"]');
        if (!meta) return;
        if (meta.content.includes("width=375")) {
          meta.content = "width=device-width, initial-scale=1";
          toast("Preview: responsive");
        } else {
          meta.content = "width=375, initial-scale=1";
          toast("Preview: 375px");
        }
      });
    })();

    /* ---------------- TRUSTED CONTACTS (WORKING) ---------------- */
    const STORAGE_KEY = "guardian_trusted_contacts_v2";

    const addBtn = document.getElementById("addBtn");
    const emptyAddBtn = document.getElementById("emptyAddBtn");
    const demoContactBtn = document.getElementById("demoContactBtn");
    const copyPlanBtn = document.getElementById("copyPlanBtn");
    const listEl = document.getElementById("list");
    const emptyState = document.getElementById("emptyState");

    // modal elements
    const modalOverlay = document.getElementById("modalOverlay");
    const closeModalBtn = document.getElementById("closeModalBtn");
    const cancelBtn = document.getElementById("cancelBtn");
    const saveBtn = document.getElementById("saveBtn");

    const nameInput = document.getElementById("nameInput");
    const relationInput = document.getElementById("relationInput");
    const phoneInput = document.getElementById("phoneInput");
    const methodSelect = document.getElementById("methodSelect");
    const notesInput = document.getElementById("notesInput");
    const editId = document.getElementById("editId");
    const roleBtns = Array.from(document.querySelectorAll(".toggle[data-role]"));

    function loadContacts(){
      try{
        const raw = localStorage.getItem(STORAGE_KEY);
        return raw ? JSON.parse(raw) : [];
      }catch(e){ return []; }
    }
    function saveContacts(contacts){
      localStorage.setItem(STORAGE_KEY, JSON.stringify(contacts));
    }

    function initials(name){
      const parts = String(name || "").trim().split(/\s+/).filter(Boolean);
      if(!parts.length) return "TC";
      const a = parts[0][0] || "";
      const b = parts.length > 1 ? (parts[parts.length - 1][0] || "") : "";
      return (a + b).toUpperCase();
    }

    function openModal(mode, contact){
      document.getElementById("modalTitle").textContent = mode === "edit" ? "Edit Trusted Contact" : "Add Trusted Contact";
      modalOverlay.style.display = "flex";
      modalOverlay.setAttribute("aria-hidden", "false");

      roleBtns.forEach(b => b.classList.remove("active"));

      if(mode === "edit" && contact){
        editId.value = contact.id;
        nameInput.value = contact.name || "";
        relationInput.value = contact.relationship || "";
        phoneInput.value = contact.phone || "";
        methodSelect.value = contact.method || "Call";
        notesInput.value = contact.notes || "";
        (contact.roles || []).forEach(r => {
          const btn = roleBtns.find(x => x.dataset.role === r);
          if(btn) btn.classList.add("active");
        });
      }else{
        editId.value = "";
        nameInput.value = "";
        relationInput.value = "";
        phoneInput.value = "";
        methodSelect.value = "Call";
        notesInput.value = "";
      }

      setTimeout(() => nameInput.focus(), 50);
    }

    function closeModal(){
      modalOverlay.style.display = "none";
      modalOverlay.setAttribute("aria-hidden", "true");
    }

    roleBtns.forEach(btn => {
      btn.addEventListener("click", () => btn.classList.toggle("active"));
    });

    addBtn.addEventListener("click", () => openModal("add"));
    emptyAddBtn.addEventListener("click", () => openModal("add"));

    demoContactBtn.addEventListener("click", () => {
      const contacts = loadContacts();
      contacts.unshift({
        id: String(Date.now()) + "_demo",
        name: "Maria Chen",
        relationship: "Daughter",
        phone: "(555) 123-4567",
        method: "Call",
        roles: ["Primary", "Verifier"],
        notes: "Can help call bank using official number"
      });
      saveContacts(contacts);
      render();
      toast("Added example contact.");
    });

    closeModalBtn.addEventListener("click", closeModal);
    cancelBtn.addEventListener("click", closeModal);
    modalOverlay.addEventListener("click", (e) => { if(e.target === modalOverlay) closeModal(); });
    document.addEventListener("keydown", (e) => { if(e.key === "Escape" && modalOverlay.style.display === "flex") closeModal(); });

    function normalizePhone(phone){
      const digits = String(phone || "").replace(/[^\d+]/g, "");
      return digits;
    }

    function render(){
      const contacts = loadContacts();
      if(!contacts.length){
        emptyState.style.display = "block";
        listEl.style.display = "none";
        listEl.innerHTML = "";
        return;
      }
      emptyState.style.display = "none";
      listEl.style.display = "flex";
      listEl.innerHTML = "";

      contacts.forEach(c => {
        const card = document.createElement("div");
        card.className = "contact";

        const left = document.createElement("div");
        left.className = "left";

        const av = document.createElement("div");
        av.className = "avatar";
        av.textContent = initials(c.name);

        const info = document.createElement("div");
        info.className = "info";

        const title = document.createElement("p");
        title.className = "cname";
        title.textContent = c.name || "Unnamed Contact";

        const meta = document.createElement("p");
        meta.className = "cmeta";

        const parts = [];
        parts.push(c.method || "Call");
        if (c.relationship) parts.push(c.relationship);
        if (c.phone) parts.push(c.phone);
        meta.textContent = parts.join(" • ");

        const tags = document.createElement("div");
        tags.className = "tags";

        const roles = Array.isArray(c.roles) ? c.roles : [];
        if(roles.includes("Primary")){
          const t = document.createElement("span");
          t.className = "tag primary";
          t.textContent = "Primary";
          tags.appendChild(t);
        }
        if(roles.includes("Verifier")){
          const t = document.createElement("span");
          t.className = "tag verify";
          t.textContent = "Verifier";
          tags.appendChild(t);
        }
        if(roles.includes("Emergency")){
          const t = document.createElement("span");
          t.className = "tag emergency";
          t.textContent = "Emergency";
          tags.appendChild(t);
        }

        const m = (c.method || "Call").toLowerCase();
        const methodTag = document.createElement("span");
        methodTag.className = "tag " + (m === "text" ? "sms" : (m === "email" ? "email" : "call"));
        methodTag.textContent = (c.method || "Call");
        tags.appendChild(methodTag);

        if(c.notes){
          const noteTag = document.createElement("span");
          noteTag.className = "tag";
          noteTag.textContent = "Notes";
          noteTag.title = c.notes;
          tags.appendChild(noteTag);
        }

        info.appendChild(title);
        info.appendChild(meta);
        info.appendChild(tags);

        left.appendChild(av);
        left.appendChild(info);

        const actions = document.createElement("div");
        actions.className = "actions";

        // Quick actions (only if phone exists)
        if (c.phone){
          const quick = document.createElement("div");
          quick.className = "quickRow";

          const phone = normalizePhone(c.phone);

          const call = document.createElement("button");
          call.className = "chipBtn";
          call.type = "button";
          call.textContent = "Call";
          call.addEventListener("click", () => {
            window.location.href = "tel:" + phone;
          });

          const text = document.createElement("button");
          text.className = "chipBtn";
          text.type = "button";
          text.textContent = "Text";
          text.addEventListener("click", () => {
            window.location.href = "sms:" + phone;
          });

          quick.appendChild(call);
          quick.appendChild(text);
          actions.appendChild(quick);
        }

        const verifyBtn = document.createElement("button");
        verifyBtn.className = "smallBtn";
        verifyBtn.type = "button";
        verifyBtn.textContent = "Copy Verify Message";
        verifyBtn.addEventListener("click", () => {
          const text = buildVerifyMessage(c);
          copyText(text);
          toast("Copied verification message.");
        });

        const editBtn = document.createElement("button");
        editBtn.className = "smallBtn";
        editBtn.type = "button";
        editBtn.textContent = "Edit";
        editBtn.addEventListener("click", () => openModal("edit", c));

        const delBtn = document.createElement("button");
        delBtn.className = "smallBtn danger";
        delBtn.type = "button";
        delBtn.textContent = "Remove";
        delBtn.addEventListener("click", () => {
          const ok = confirm(`Remove ${c.name || "this contact"}?`);
          if(!ok) return;
          const contactsNow = loadContacts().filter(x => x.id !== c.id);
          saveContacts(contactsNow);
          render();
          toast("Contact removed.");
        });

        actions.appendChild(verifyBtn);
        actions.appendChild(editBtn);
        actions.appendChild(delBtn);

        card.appendChild(left);
        card.appendChild(actions);

        listEl.appendChild(card);
      });
    }

    function buildVerifyMessage(contact){
      const name = contact.name || "there";
      const method = contact.method || "Call";
      const roles = (contact.roles || []).join(", ");

      return (
`Hi ${name} — quick check: I just got something suspicious.
Can you help me verify it before I respond?

What happened:
• Type: (call/text/email)
• Who they claimed to be:
• What they asked for:
• Why it felt urgent:

My plan:
1) I will NOT click links or share codes.
2) I will call back using an official number (not the one provided).
3) If it involves money/info, I’ll pause and verify with you.

Your role: ${roles || "Trusted Contact"} • Preferred method: ${method}`
      );
    }

    function collectRolesFromUI(){
      return roleBtns.filter(b => b.classList.contains("active")).map(b => b.dataset.role);
    }

    saveBtn.addEventListener("click", () => {
      const name = nameInput.value.trim();
      if(!name){
        toast("Please enter a name.");
        nameInput.focus();
        return;
      }

      const contact = {
        id: editId.value || String(Date.now()) + "_" + Math.random().toString(16).slice(2),
        name,
        relationship: relationInput.value.trim(),
        phone: phoneInput.value.trim(),
        method: methodSelect.value,
        roles: collectRolesFromUI(),
        notes: notesInput.value.trim()
      };

      const contacts = loadContacts();
      const idx = contacts.findIndex(x => x.id === contact.id);
      if(idx >= 0) contacts[idx] = contact;
      else contacts.unshift(contact);

      saveContacts(contacts);
      closeModal();
      render();
      toast(idx >= 0 ? "Contact updated." : "Contact added.");
    });

    copyPlanBtn.addEventListener("click", () => {
      const text =
`Quick Verification Plan (Guardian AI)

1) Pause: do not act immediately.
2) Verify independently:
   - Call the company/person using a saved or official number.
   - Never use a number/link provided in the message.
3) Never share:
   - passwords, 2FA codes, gift card numbers, bank login, remote access.
4) If money/info was shared:
   - Contact bank/provider immediately and tell a trusted contact.
5) If it feels urgent or secret: treat it as suspicious.

Tip: Set a family code word for emergencies.`;

      copyText(text);
      toast("Copied verification plan.");
    });

    /* ---------------- MOCK AI (template generator) ---------------- */
    const chat = document.getElementById("chat");
    const aiInput = document.getElementById("aiInput");
    const mockSendBtn = document.getElementById("mockSendBtn");
    const insertPromptBtn = document.getElementById("insertPromptBtn");
    const copyDraftBtn = document.getElementById("copyDraftBtn");
    const clearChatBtn = document.getElementById("clearChatBtn");
    const greetingMsg = document.getElementById("greetingMsg");

    let latestDraft = "";

    insertPromptBtn.addEventListener("click", () => {
      aiInput.value = "A caller said they were my bank. They told me my account was hacked and I need to move money now. They asked for a code they texted me.";
      aiInput.focus();
    });

    function addMsg(text, cls){
      const div = document.createElement("div");
      div.className = "msg " + cls;
      div.textContent = text;
      chat.appendChild(div);
      chat.scrollTop = chat.scrollHeight;
    }

    function makeMockDraft(userText){
      const trimmed = String(userText || "").trim();
      const summary = trimmed ? trimmed.slice(0, 220) + (trimmed.length > 220 ? "…" : "") : "(no details provided)";
      return (
`Draft message to send:

“Hi — I received something suspicious and I want a second opinion before I respond.
Summary: ${summary}

Can you help me verify:
1) Who this is really from (call back using official numbers)?
2) Whether I should ignore/report it?

I will NOT share passwords or verification codes, and I won’t click any links.”`
      );
    }

    function handleSend(){
      const text = aiInput.value.trim();
      if(!text){
        toast("Type what happened first.");
        aiInput.focus();
        return;
      }
      addMsg(text, "me");
      latestDraft = makeMockDraft(text);
      addMsg(latestDraft, "ai");
      aiInput.value = "";
      aiInput.focus();
    }

    mockSendBtn.addEventListener("click", handleSend);
    aiInput.addEventListener("keydown", (e) => {
      if(e.key === "Enter"){
        e.preventDefault();
        handleSend();
      }
    });

    copyDraftBtn.addEventListener("click", () => {
      if(!latestDraft){
        toast("No draft yet. Create one first.");
        return;
      }
      copyText(latestDraft);
      toast("Copied latest draft.");
    });

    clearChatBtn.addEventListener("click", () => {
      chat.innerHTML = "";
      if (greetingMsg) chat.appendChild(greetingMsg);
      latestDraft = "";
      toast("Cleared.");
    });

    /* ---------------- UTILITIES ---------------- */
    function copyText(text){
      if(navigator.clipboard && navigator.clipboard.writeText){
        navigator.clipboard.writeText(text).catch(() => fallbackCopy(text));
      }else{
        fallbackCopy(text);
      }
    }
    function fallbackCopy(text){
      const ta = document.createElement("textarea");
      ta.value = text;
      ta.style.position = "fixed";
      ta.style.left = "-9999px";
      document.body.appendChild(ta);
      ta.select();
      try{ document.execCommand("copy"); }catch(e){}
      document.body.removeChild(ta);
    }

    let toastTimer = null;
    function toast(message){
      let el = document.getElementById("toast");
      if(!el){
        el = document.createElement("div");
        el.id = "toast";
        el.style.position = "fixed";
        el.style.bottom = "18px";
        el.style.left = "50%";
        el.style.transform = "translateX(-50%)";
        el.style.background = "#0f172a";
        el.style.color = "#fff";
        el.style.padding = "10px 12px";
        el.style.borderRadius = "12px";
        el.style.fontWeight = "900";
        el.style.fontSize = "13px";
        el.style.boxShadow = "0 14px 30px rgba(0,0,0,.20)";
        el.style.zIndex = "999999";
        el.style.maxWidth = "92vw";
        el.style.textAlign = "center";
        el.style.opacity = "0";
        el.style.transition = "opacity .15s ease";
        document.body.appendChild(el);
      }
      el.textContent = message;
      el.style.opacity = "1";
      clearTimeout(toastTimer);
      toastTimer = setTimeout(() => { el.style.opacity = "0"; }, 1400);
    }

    // initial render
    render();
  </script>
</body>
</html>